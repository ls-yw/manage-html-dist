(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7c741c25"],{3511:function(t,e,l){},"445c":function(t,e,l){"use strict";l.r(e);var i=function(){var t=this,e=t.$createElement,l=t._self._c||e;return l("div",{staticClass:"app-container"},[l("div",{staticClass:"filter-container"},[l("el-button",{staticClass:"filter-item",attrs:{size:"mini",type:"success"},on:{click:t.handleBatchCollected}},[t._v(" 已采集 ")])],1),l("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],attrs:{data:t.list,"element-loading-text":"Loading",border:"",fit:"","highlight-current-row":""},on:{"selection-change":t.handleSelectionChange}},[l("el-table-column",{attrs:{type:"selection",width:"55"}}),l("el-table-column",{attrs:{align:"center",label:"ID",prop:"id",width:"95"}}),l("el-table-column",{attrs:{align:"center",label:"小说ID",prop:"book_id",width:"95"}}),l("el-table-column",{attrs:{label:"标题",prop:"from_title"}}),l("el-table-column",{attrs:{label:"排序",prop:"from_sort",width:"80",align:"center"}}),l("el-table-column",{attrs:{"class-name":"status-col",label:"状态",width:"80",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[l("el-tag",{attrs:{type:0===e.row.from_status?"danger":"success"}},[t._v(t._s(e.row.from_status_name))])]}}])}),l("el-table-column",{attrs:{label:"目标网址",prop:"from_url",width:"200",align:"center","show-overflow-tooltip":""}}),l("el-table-column",{attrs:{label:"文章内容地址",prop:"url",width:"150",align:"center","show-overflow-tooltip":""}}),l("el-table-column",{attrs:{label:"创建时间",prop:"created_at",align:"center",width:"160"}}),l("el-table-column",{attrs:{label:"更新时间",prop:"updated_at",align:"center",width:"160"}}),l("el-table-column",{attrs:{align:"center",label:"操作",width:"210"},scopedSlots:t._u([{key:"default",fn:function(e){return[l("el-button",{attrs:{type:"success",size:"mini"},on:{click:function(l){return t.handleCollected(e.row)}}},[t._v(" 已采集 ")]),l("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(l){return t.handleAdd(e.row)}}},[t._v(" 添加 ")])]}}])})],1),l("pagination",{directives:[{name:"show",rawName:"v-show",value:t.total>0,expression:"total>0"}],attrs:{total:t.total,page:t.listQuery.page,limit:t.listQuery.size},on:{"update:page":function(e){return t.$set(t.listQuery,"page",e)},"update:limit":function(e){return t.$set(t.listQuery,"size",e)},pagination:t.getList}}),l("el-dialog",{attrs:{visible:t.dialogEdit,title:"添加章节",width:"800px",center:""},on:{"update:visible":function(e){t.dialogEdit=e}}},[l("el-form",{ref:"editObj",attrs:{rules:t.rules,model:t.editObj,"label-position":"left","label-width":"100px"}},[l("el-form-item",{attrs:{label:"文章标题",prop:"title"}},[l("el-input",{model:{value:t.editObj.title,callback:function(e){t.$set(t.editObj,"title",e)},expression:"editObj.title"}})],1),l("el-form-item",{attrs:{label:"所属章节",prop:"chapter_id"}},[l("el-select",{attrs:{placeholder:"请选择"},model:{value:t.editObj.chapter_id,callback:function(e){t.$set(t.editObj,"chapter_id",e)},expression:"editObj.chapter_id"}},t._l(t.chapterPairs,(function(t){return l("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),l("el-form-item",{attrs:{label:"排序",prop:"sort"}},[l("el-input",{model:{value:t.editObj.sort,callback:function(e){t.$set(t.editObj,"sort",e)},expression:"editObj.sort"}})],1),l("el-form-item",{attrs:{label:"内容",prop:"content"}},[l("tinymce",{ref:"tin",model:{value:t.editObj.content,callback:function(e){t.$set(t.editObj,"content",e)},expression:"editObj.content"}})],1)],1),l("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[l("el-button",{attrs:{type:"primary"},on:{click:t.handleSave}},[t._v("保存")]),l("el-button",{on:{click:function(e){t.dialogEdit=!1}}},[t._v("取消")])],1)],1)],1)},n=[],o=l("1da1"),r=(l("96cf"),l("d3b7"),l("159b"),l("333d")),a=l("b637"),c=l("e000"),s=l("8256"),u=l("3e18"),d={name:"Article",components:{Pagination:r["a"],Tinymce:s["a"]},data:function(){return{list:null,total:0,listQuery:{page:1,size:20,bookId:this.$route.query.bookId},listLoading:!0,dialogEdit:!1,editObj:{},rules:{title:[{required:!0,message:"标题不能为空",trigger:"blur"}],chapter_id:[{required:!0,message:"请选择章节",trigger:"blur"}],sort:[{required:!0,message:"排序不能为空",trigger:"blur"}],content:[{required:!0,message:"内容不能为空",trigger:"blur"}]},multipleSelection:[],chapterPairs:[]}},created:function(){this.getChapterPairs(),this.getList()},methods:{getList:function(){var t=this;this.listLoading=!0,Object(a["c"])(this.listQuery).then((function(e){t.list=e.list,t.total=e.total,t.listLoading=!1}))},getChapterPairs:function(){var t=this;Object(c["f"])(this.listQuery).then((function(e){t.chapterPairs=e.data}))},handleSelectionChange:function(t){this.multipleSelection=t,console.log(this.multipleSelection)},handleBatchCollected:function(){var t=this;if(0===this.multipleSelection.length)return this.$message.error("请先选择要确认的章节"),!1;this.$confirm("确定修改已采集","已采集确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(o["a"])(regeneratorRuntime.mark((function e(){var l;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:l=[],t.multipleSelection.forEach((function(t){l.push(t.id)})),Object(a["a"])({id:l}).then((function(e){t.getList(),t.$message.success("设置成功")}));case 3:case"end":return e.stop()}}),e)})))).catch((function(){}))},handleCollected:function(t){this.multipleSelection=[],this.multipleSelection.push(t),this.handleBatchCollected()},handleAdd:function(t){this.dialogEdit=!0,this.editObj={title:t.from_title,sort:t.from_sort,chapter_id:this.chapterPairs[0].value,book_id:this.$route.query.bookId,collect_from_id:t.id},this.$refs.tin.setContent("")},handleSave:function(){var t=this;this.$refs.editObj.clearValidate(),this.$refs.editObj.validate((function(e){if(!e)return console.log("error submit!!"),!1;Object(u["d"])(t.editObj).then((function(e){0===e.code?(t.$message.success("保存成功"),t.dialogEdit=!1,t.getList()):t.$message.error(e.msg)}))}))}}},p=d,h=(l("5938"),l("2877")),f=Object(h["a"])(p,i,n,!1,null,"4434620c",null);e["default"]=f.exports},5938:function(t,e,l){"use strict";l("3511")},b637:function(t,e,l){"use strict";l.d(e,"e",(function(){return n})),l.d(e,"c",(function(){return o})),l.d(e,"a",(function(){return r})),l.d(e,"f",(function(){return a})),l.d(e,"d",(function(){return c})),l.d(e,"h",(function(){return s})),l.d(e,"b",(function(){return u})),l.d(e,"g",(function(){return d})),l.d(e,"i",(function(){return p}));var i=l("b775");function n(t){return Object(i["a"])({url:"/novel/collect/list",method:"get",params:t})}function o(t){return Object(i["a"])({url:"/novel/collect/article",method:"get",params:t})}function r(t){return Object(i["a"])({url:"/novel/collect/confirmArticle",method:"post",data:t})}function a(t){return Object(i["a"])({url:"/novel/collect/test",method:"post",data:t})}function c(t){return Object(i["a"])({url:"/novel/collect/info",method:"get",params:t})}function s(t){return Object(i["a"])({url:"/novel/collect/save",method:"post",data:t})}function u(t){return Object(i["a"])({url:"/novel/collect/delete",method:"post",data:t})}function d(t){return Object(i["a"])({url:"/novel/collect/collectBookInfo",method:"post",data:t})}function p(t){return Object(i["a"])({url:"/novel/collect/collectSaveBookInfo",method:"post",data:t})}}}]);